<!DOCTYPE html>
<html lang="en-US" prefix="og: https://ogp.me/ns#">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- script -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

    <!-- Country code plugin css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.12/css/intlTelInput.css">
    <!--Country code library-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.12/js/intlTelInput.js"></script>
    <!-- BOOTSTRAP Select -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.18/js/bootstrap-select.min.js"
        crossorigin="anonymous"></script>

    <!-- footer -->
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script> -->
    <!-- footer end -->
<style>
    .bg-primary-gradient-radial {
    color: #fff;
    background: radial-gradient(50% 100% at 50% 0%, #6902DF 0%, #390179 100%);
}
.block-absolute--right {
    background-color: rgba(0, 0, 0, 0);
    left: auto;
    height: auto;
    right: 0;
    width: auto;
    padding: 0 18px;
    overflow-x: hidden;
    overflow-y: hidden;
}
</style>
    
</head>

<body">
    <!--SEARCH NUMBER-->
    <section class="">
        <div class="container-virtual-search">
            <div class="bg-primary-gradient-radial block-relative px-3 border-r-16 ">
                <div class="block-absolute--right pr-0">
                    <img decoding="async" src="/wp-content/themes/mitech/src/assets/images/world-map-2.png" alt="Call">
                </div>
                <div class="container-virtual-search">
                    <div class="search-form search-form--table item-center two-col py-5 min-h-494">
                        <div class="block-absolute--left w-auto">
                            <img decoding="async" src="/wp-content/themes/mitech/src/assets/images/world-map.png"
                                alt="Call">
                        </div>
                        <div class="center-item block-relative">
                            <div class="align-items-center d-flex pl-0 max-527">
                                <div class="text-center">
                                    <h3 class="text-2 pb-3 text-white">
                                        Get a Virtual Number</h3>
                                    <p>Get local, mobile, and
                                        toll-free virtual phone
                                        numbers from 100+ countries
                                        and expand your business
                                        worldwide.</p>
                                </div>
                            </div>
                            <div class="p-0 mt-5">
                                <div class="search-num search-num--table" id="search-num">
                                    <form action="#" id="search-number" class="max-527">
                                        <div class="form-row justify-content-center m-0">
                                            <div class="col-md col-fixed-width p-0">
                                                <div class="form-group form-ccwrapper text-left mb-0">
                                                    <input type="text" class="form-control" id="phoneNum"
                                                        name="phone-num" required>
                                                </div>
                                            </div>
                                            <div class="col-auto ml-2 ml-md-0 pr-0">
                                                <div class="form-action text-center">
                                                    <button class="btn btn-primary-lt" id="search-open">Search<span
                                                            class="preloader preloader-sm"></span></button>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                    <div class="search-results collapse" id="search-results">
                                        <div class="selected-list selected-list-table" id="selected-list">
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer Section -->
    <footer>
       
        <!-- Mixpanel Integration -->
        <script type="text/javascript">

            //Search Number
            $('.selectpicker').selectpicker({ dropupAuto: false });
            //International number country code
            var countryList = window.intlTelInputGlobals.getCountryData(),
                //Updating Input field with selected country from footer
                cn = [];
            for (const a in countryList) {
                var countryTrimmed = $.trim(countryList[a].name.split("(")[0])
                cn.push(countryTrimmed);
            }

            //Getting country iso
            var selectedArea = document.querySelector("#client");
            selectedVal = selectedArea && selectedArea.options[selectedArea.selectedIndex].value;
            phoneNum = document.querySelector('#phoneNum');
            selectCountryInbound = document.querySelector('#selectCountryInbound');
            selectCountryOutbound = document.querySelector('#selectCountryOutbound');
            tableOutbound = document.querySelector('.table-outbound');
            telInput1 = document.querySelector('.searchNum');
            currUrl = window.location.href.split('/');
            currPath = window.location.pathname.split(".")[0].substring(1);
            lastElm = currUrl[currUrl.length - 1];
            seclastElm = currUrl[currUrl.length - 2].split('-').join(' ');
            regex = /(^|\b(?!(and?|at?|the|for|to|but|by)\b))\w+/g;
            getCn = currUrl.pop();
            let telInput = (phoneNum == null) ? telInput1 : phoneNum;
            // telInput = (phoneNum == null && selectCountryInbound == null) ? telInput1 : telInput;
            getCn = (getCn == "") ? seclastElm : getCn;
            titleWithNumber = getCn.replace('number', '');
            getCnTitleCase = titleWithNumber.trim().toLowerCase().replace(regex, s => s[0].toUpperCase() + s.slice(1));
            //if county iso is undefined
            if (typeof cnIso == "undefined") {
                cnIso = "us"
            }
            if (currUrl[3] == "virtual-phone-number" && currUrl.length < 6) {
                // getCnTitleCase = getCn.charAt(0).toUpperCase() + getCn.substr(1).toLowerCase(),
                getCnTitleCase = (getCnTitleCase == "Virtual Phone Number" || currPath == "virtual-phone-number/" || currPath == "/" || currPath == "") ? 'Australia' : getCnTitleCase;
                getCnTitleCase = (getCnTitleCase == "Usa" || getCnTitleCase == "usa") ? 'United States' : getCnTitleCase;
                cnIso = countryList[$.inArray(getCnTitleCase, cn)].iso2;
            }
            if (currUrl[3] == "virtual-phone-number" && currUrl.length === 6) {
                getCnTitleCase = (getCnTitleCase == "Virtual Phone Number" || currPath == "virtual-phone-number/" || currPath == "/" || currPath == "") ? 'Australia' : getCnTitleCase;
                getCnTitleCase = (getCnTitleCase == "Usa" || getCnTitleCase == "usa") ? 'United States' : getCnTitleCase;
            }
            var iti = window.intlTelInput(telInput, {
                separateDialCode: true,
                onlyCountries: ["ar", "au", "at", "ba", "bb", "be", "bj", "br", "bg", "ca",
                    "cl", "co", "cz", "de", "dk", "dz", "ec", "ee", "fi", "fr", "gb", "gh", "gd", "gr",
                    "hk", "hr", "hu", "is", "id", "ie", "il", "jm", "ke", "ky", "lt", "mo", "ml", "mu",
                    "mx", "my", "na", "nl", "nz", "pa", "pe", "ph", "pl", "pt", "pr", "ro", "sg", "si", "sk", "sv",
                    "za", "se", "ch", "th", "tn", "tt", "us", "ug", "vz"], //Show only selected country
                initialCountry: cnIso // INITIAL SELECTED COUNTRY
            });
            if (selectCountryInbound) {
                var intlInboundInput = window.intlTelInput(selectCountryInbound, {
                    utilsScript: "https://cdn.jsdelivr.net/npm/intl-tel-input@17.0.8/build/js/utils.js",
                    separateDialCode: true,
                    onlyCountries: ["ar", "au", "at", "ba", "bb", "be", "bj", "br", "bg", "ca",
                        "cl", "co", "cz", "de", "dk", "dz", "ec", "ee", "fi", "fr", "gb", "gh", "gd",
                        "hk", "hr", "hu", "is", "id", "ie", "il", "jm", "ke", "ky", "lt", "mo", "ml", "mu",
                        "mx", "my", "na", "nl", "nz", "pa", "pe", "ph", "pl", "pt", "pr", "ro", "sg", "si", "sk", "sv",
                        "za", "se", "ch", "th", "tn", "tt", "us", "ug", "vz"], //Show only selected country
                    customPlaceholder: () => 'Select a Country',
                    initialCountry: 'ug' // INITIAL SELECTED COUNTRY

                });

            }

            if (selectCountryOutbound) {
                // intlInboundInput.countries.unshift();
                var intlOutboundInput = window.intlTelInput(selectCountryOutbound, {
                    separateDialCode: true,
                    placeholder: 'polite',
                    // onlyCountries: ["ar", "au", "at", "ba", "bb", "be", "bj", "br", "bg", "ca",
                    //                         "cl", "co", "cz", "de", "dk", "dz", "ec", "ee", "fi", "fr", "gb", "gh", "gd",
                    //                         "hk", "hr", "hu", "is", "id", "ie", "il", "jm", "ke", "ky", "lt", "mo", "ml", "mu",
                    //                         "mx", "my","na", "nl", "nz", "pa", "pe", "ph", "pl", "pt", "pr", "ro", "sg", "si", "sk",  "sv",
                    //                         "za", "se", "ch", "th", "tn", "tt", "us", "ug", "vz"], //Show only selected country
                    onlyCountries: ["af", "al", "dz", "as", "ad", "ao", "ai", "aq", "ag", "ar", "am", "aw", "au", "at",
                        "az", "bs", "bh", "bd", "bb", "by", "be", "bz", "bj", "bm", "bt", "bo", "ba", "bw", "bv", "br", "io",
                        "bn", "bg", "bf", "bi", "kh", "cm", "ca", "cv", "ky", "cf", "td", "cl", "cn", "cx", "cc", "co", "km",
                        "cg", "cd", "ck", "cr", "ci", "hr", "cu", "cy", "cz", "dk", "dj", "dm", "do", "ec", "eg", "sv", "gq",
                        "er", "ee", "et", "fk", "fo", "fj", "fi", "fr", "gf", "pf", "tf", "ga", "gm", "ge", "de", "gh", "gi",
                        "gr", "gl", "gd", "gp", "gu", "gt", "gn", "gw", "gy", "ht", "hm", "va", "hn", "hk", "hu", "is", "in",
                        "id", "ir", "iq", "ie", "il", "it", "jm", "jo", "kz", "ke", "ki", "kp", "kr", "kw", "kg", "la",
                        "lv", "lb", "ls", "lr", "ly", "li", "lt", "lu", "mo", "mk", "mg", "mw", "my", "mv", "ml", "mt", "mh",
                        "mq", "mr", "mu", "yt", "mx", "fm", "md", "mc", "mn", "ms", "ma", "mz", "mm", "na", "nr", "np", "nl",
                        "an", "nc", "nz", "ni", "ne", "ng", "nu", "nf", "mp", "no", "om", "pk", "pw", "ps", "pa", "pg", "py",
                        "pe", "ph", "pn", "pl", "pt", "pr", "qa", "re", "ro", "ru", "rw", "sh", "kn", "lc", "pm", "vc", "ws",
                        "sm", "st", "sa", "sn", "sc", "sl", "sg", "sk", "si", "sb", "so", "za", "gs", "es", "lk", "sd", "sr",
                        "sj", "sz", "se", "ch", "sy", "tw", "tj", "tz", "th", "tl", "tg", "tk", "to", "tt", "tn", "tr", "tm",
                        "tc", "tv", "ug", "ua", "ae", "gb", "us", "um", "uy", "uz", "vu", "ve", "vn", "vg", "vi", "wf", "eh",
                        "ye", "zm", "zw"], //Show only selected country
                    initialCountry: 'us' // INITIAL SELECTED COUNTRY
                });
            }
            // let sessionValue = sessionStorage.getItem('country');
            // sessionValue = (sessionValue =='US') ? 'United States' : sessionValue;
            // sessionValue = (sessionValue =='UK') ? 'United Kingdom' : sessionValue;
            // if(sessionStorage.getItem('country')){
            //     if($.inArray(sessionValue,cn) != -1){
            //         iti.setCountry(countryList[$.inArray(sessionValue,cn)].iso2);
            //     }
            // }
            //Defining elements to variables
            var select, selectedText;
            searchNumbers = document.getElementById('search-open');
            checkBtn = document.querySelector('.check-btn');
            checkPortingBtn = document.querySelector('.check-porting');
            searchResults = document.getElementById('search-results');
            selectedList = document.getElementById('selected-num');
            searchNum = document.querySelector('.search-num');
            checkNum = document.querySelector('.check-num');
            cardNum = document.getElementById('selected-list');
            cardResult = document.querySelector('.card-result');
            inputNumber = document.querySelector('.checkNumber');
            inputNumberPorting = document.getElementById('checkNumberPorting');
            searchFooter = document.querySelector('.search-results .search-footer');
            searchFooterBtn = document.querySelector('.search-results .search-footer .btn');
            inputText = document.querySelector('.iti__selected-dial-code');
            loader = document.querySelector('.preloader-sm');
            noLocality = ["No Locality found"];
            failedToFetch = `<div class="text-center mt-5"><span class="d-block text-bold text-9 mb-2">Failed to Fetch!</span><p class="text-10">There is possibility of obtaining numbers privately. <br/>Please contact support for further details</p> <a class="btn btn-success mt-4" id="closeSignup" onClick="collapse()">Contact Support</a></div>`;
            noMatchFound = `<div class="text-center mt-5"><span class="d-block text-bold text-9 mb-2">No Match Found!</span><p class="text-10">There is possibility of obtaining numbers privately. <br/>Please contact support for further details</p> <a class="btn btn-success mt-4" id="closeSignup" onClick="collapse()">Contact Support</a></div>`;
            countryFlag = document.querySelector('.country-flag');
            selectedListTable = document.querySelector('.selected-list-table');
            rightMapHeight = document.querySelector('.block-absolute--right img');
            leftMapHeight = document.querySelector('.block-absolute--left img');
            searchFormHeight = document.querySelector('.search-form')?.clientHeight;
            //setTimeOut function for delay
            const delay = time => new Promise(res => setTimeout(res, time));
            //Change function
            //Update field on countrychange(Is an event of plugin itself)
            phoneNum && telInput.addEventListener("countrychange", function () {
                updateField(iti, '.search-num');
                // selectedList.innerHTML = "";
                searchResults.style.height = "0";
                searchResults.style.filter = "blur(3px)";
                searchResults.classList.remove('mt-5');
            });
            //update input field with country code and country name(default only displayed country code)
            function updateField(updateCountry, id) {
                let parentElm = document.querySelector(id);
                dialCode = parentElm?.querySelector('.iti__selected-dial-code');
                dialCode.textContent = '+' + updateCountry.getSelectedCountryData().dialCode + '(' + updateCountry.getSelectedCountryData().name + ')';
                telInput.value = '+' + updateCountry.getSelectedCountryData().dialCode + ' ' + updateCountry.getSelectedCountryData().name;

                //fetching locality of selected countries
                let payload = {
                    country: updateCountry.getSelectedCountryData().iso2.toUpperCase(), //SHORT CODE OF SELECTED COUNTRY
                }
                //Change  select dropdown for locality
                let localityId = document.querySelector('#search-locality');
                if (localityId) {
                    fetch('https://uat.safefamilyapp.com/get-locality', {
                        method: 'POST', // or 'PUT'
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(payload),
                    })
                        .then(response => response.json())
                        .then(resp => {
                            if (resp.length > 0) {
                                resp.unshift("Select Locality");
                                loadLocality(resp);
                            } else {
                                loadLocality(noLocality);
                            }
                        })
                        .catch((error) => {
                            console.error('Error:', error);
                        });
                }

                //checking if selected field number type, undefined or not null
                else if (typeof optArr == "undefined" && selectedVal !== null && selectedVal !== "Number Type" && selectedVal !== "Mobile" && selectedVal !== "Mobile" && selectedVal !== "Toll Free") {
                    let opt = ['Number Type', 'Mobile', 'Local', 'Toll Free'];
                    loadLocality(opt);
                }
                else if (typeof optArr !== "undefined") {
                    loadLocality(optArr);
                }
            }
            selectCountryInbound && updateField(intlInboundInput, '.table-inbound');
            selectCountryOutbound && updateField(intlOutboundInput, '.table-outbound');
            if (searchNum) {
                updateField(iti, '.search-num');
            }

            // SELECT TYPE LOCALITY OR NUMBER FUNCTIONS
            function loadLocality(resp) {
                selectedArea.innerHTML = '';
                var stateSession = sessionStorage.getItem('state');
                urlStateTitleCase = getCn.split(' ')
                    .map(c => c[0].toUpperCase() + c.substring(1).toLowerCase())
                    .join(' ');

                // stateSession = (stateSession == null || urlStateTitleCase !=='' ) ? urlStateTitleCase : stateSession;
                indx = resp.findIndex((id) => id == urlStateTitleCase);
                const curState = currUrl[3] == "virtual-phone-number" && getCnTitleCase !== "" && currUrl.length === 6
                for (var i = 0; i < resp.length; i++) {
                    var opt = resp[i];
                    var el = document.createElement("option");
                    el.textContent = opt;
                    el.value = opt;
                    el.value = (el.value == "Select Locality" || el.value == "No Locality Found") ? 'No Locality found' : el.value;
                    el.value = (el.value == "Number Type" || el.value == "No Locality Found") ? '' : el.value;
                    el.value = (el.value == "Toll Free") ? 'TollFree' : el.value;
                    selectedArea.appendChild(el);
                    if (i == 0 || (curState && i == indx)) {
                        el.setAttribute('selected', '')
                    }
                }
                $('.selectpicker').selectpicker();
                $('.selectpicker').selectpicker('refresh');
            }

            // fetch API for search numbers
            searchNumbers && searchNumbers.addEventListener('click', function (e) {
                e.preventDefault();
                loader.classList.add('d-block');
                let parentElm = e.target.closest('.search-form');
                var selectedCountry = iti.getSelectedCountryData().iso2.toUpperCase(),
                    filterSelector = document.querySelector('.search-num .filter-option-inner-inner')
                filterOption = filterSelector && filterSelector.innerHTML;
                updatedAreaSelected = document.querySelector("#client");
                area = updatedAreaSelected ? updatedAreaSelected?.options[updatedAreaSelected.selectedIndex].value : '';
                if (!selectedListTable) searchFooterBtn.innerHTML = "Sign up & Purchase";
                let numberTypeData = {
                    limit: 6,
                    country: selectedCountry, //SHORT CODE OF SELECTED COUNTRY
                    type: area
                };
                let localityData = {
                    limit: 6,
                    country: selectedCountry, //SHORT CODE OF SELECTED COUNTRY
                    locality: area
                };
                const isUrlMatched = currUrl[3] === "virtual-phone-number" && currUrl.length === 6;
                const isFilter = filterOption === "Select Locality";
                const numberType = ['Local', 'Mobile', 'Toll Free'];
                const isNumberType = numberType.includes(filterOption);
                const updatedData = isNumberType ? numberTypeData : localityData;
                fetch('https://uat.safefamilyapp.com/get-numbers', {
                    method: 'POST', // or 'PUT'
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(updatedData),
                })
                    .then(async (response) => {
                        searchResults.classList.add('collapsing');
                        if (response.ok == true) {
                            return await response.json();
                        }
                        return Promise.reject(response); // 2. reject instead of throw
                    })
                    .then(resp => {
                        var checkNumber;
                        try {
                            checkNumber = checkNum.value;
                        } catch (error) {
                            checkNumber = "";
                        }
                        searchResults.classList.add('show');
                        searchResults.style.filter = "blur(0)";
                        loadData(resp, parentElm);
                        loader.classList.remove('d-block');

                        // selectedList.innerHTML = "";
                        this.dataset.target = "#search-results";
                        this.dataset.toggle = "collapse";
                        if (resp.length == 0 && searchNum) {
                            searchFooter?.classList.add('d-none');
                        }
                        else {
                            searchFooter?.classList.remove('d-none');
                        }
                        searchResults.style.height = searchResults.scrollHeight + "px";

                        //Because the card components are loaded after data is fetched, event driven function is called after card is loaded
                        // cardSelect();
                    })
                    .catch((error) => {
                        console.error('Error:', error);
                        div = document.createElement('div');
                        div.classList = "toast";
                        msg = `
                        <div class="toast-content d-flex">
                            <span class="icon icon-xs icon-danger mr-1"></span>
                            <div class="message">
                                <span class="text text-12">Oops! Something went wrong...</span>
                            </div>
                        </div>`
                        div.innerHTML = msg;
                        document.body.appendChild(div);
                        toast = document.querySelector('.toast');
                        // toast.classList.add('active');
                        setTimeout(() => {
                            toast.classList.add('active');
                        }, 100);
                        setTimeout(() => {
                            toast.classList.remove('active');
                        }, 3000);
                        setTimeout(() => {
                            toast.remove();
                            loader.classList.remove('d-block');
                        }, 3500);

                    });
            })
            //mixapnel function
            function mixpanelEvent(eventName, eventProperties) {
                mixpanel?.track(eventName, eventProperties);
            }
            // fetch API for checking numbers availabilty check btn clicked
            checkBtn && checkBtn.addEventListener('click', function (e) {
                let parentElm = e.target.closest('.check-num');
                var checkDialCode = itiFlag.getSelectedCountryData().dialCode;
                e.preventDefault();
                cardNum.innerHTML = "";
                if (inputNumber.value.trim() === "" || inputNumber.value === "" || inputNumber.value === null) {
                    if (!checkError) {
                        inputNumber.classList.add('error');
                        cardNum.classList.add('d-none');
                        searchResults.classList.add('d-none');
                        span = document.createElement('span');
                        span.classList = "text-error block-absolute";
                        span.innerText = 'This field is required';
                        isertAfter(inputNumber, span);
                        setTimeout(() => {
                            document.querySelector('.text-error').classList.add('show');

                        }, 100);
                    }
                    checkError = true;
                    return
                }

                var isValidPhone,
                    payload = {};
                if (searchNum) {
                    var selectedCountry = iti.getSelectedCountryData().iso2.toUpperCase(),
                        area = selectedArea.options[selectedArea.selectedIndex].value;
                    payload = {
                        limit: 8,
                        country: selectedCountry, //SHORT CODE OF SELECTED COUNTRY
                        type: area
                    }
                }
                //trim and remove spaces from value
                var refinedNumber = inputNumber.value.replace(/[^\d\+]/g, '');
                const finalInputNum = checkDialCode + refinedNumber;
                payload = {
                    number: finalInputNum
                }
                // phoneRe.test(refinedNumber);
                var isValidPhone = /^(1\s|1|)?((\(\d{3}\))|\d{3})(\-|\s)?(\d{3})(\-|\s)?(\d{4})$/.test(finalInputNum);
                // const isValid= /^\+?[\d ]+/
                // var validateNum = /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/.test(finalInputNum);
                var validateNum = /^\+?[\d ]+([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{3})$/.test(finalInputNum);
                const plusValid = isValid.test(finalInputNum)

                if (plusValid === false || validateNum === false || finalInputNum.length >= 20) {
                    const parentTarget = e.target.closest('.check-num')
                    let checkTextError = parentTarget.querySelector('.text-error')
                    cardNum.classList.remove('mt-3', 'pt-2');
                    if (checkTextError !== null) {
                        return
                    }
                    searchResults.classList.remove('mt-3')
                    div = document.createElement('div');
                    div.classList = "toast";
                    msg = `
                        <div class="toast-content d-flex align-items-center">
                            <span class="icon icon-xs mr-1">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <g clip-path="url(#clip0_7653_560372)">
                                    <path d="M10.7218 2.50061L18.6602 16.2506C18.7333 16.3773 18.7718 16.521 18.7718 16.6673C18.7718 16.8136 18.7333 16.9573 18.6602 17.0839C18.587 17.2106 18.4818 17.3158 18.3552 17.389C18.2285 17.4621 18.0848 17.5006 17.9385 17.5006H2.06183C1.91555 17.5006 1.77185 17.4621 1.64517 17.389C1.51849 17.3158 1.41329 17.2106 1.34016 17.0839C1.26702 16.9573 1.22851 16.8136 1.22852 16.6673C1.22852 16.521 1.26702 16.3773 1.34016 16.2506L9.27849 2.50061C9.35164 2.37394 9.45683 2.26875 9.58351 2.19562C9.71019 2.12249 9.85389 2.08398 10.0002 2.08398C10.1464 2.08398 10.2901 2.12249 10.4168 2.19562C10.5435 2.26875 10.6487 2.37394 10.7218 2.50061V2.50061ZM9.16683 13.3339V15.0006H10.8335V13.3339H9.16683ZM9.16683 7.50061V11.6673H10.8335V7.50061H9.16683Z" fill="#E07408"/>
                                    </g>
                                    <defs>
                                    <clipPath id="clip0_7653_560372">
                                    <rect width="20" height="20" fill="white"/>
                                    </clipPath>
                                    </defs>
                                </svg>
                            </span>
                            <div class="message">
                                <span class="text text-12 text-900"> Number is invalid</span>
                            </div>
                        </div>`
                    div.innerHTML = msg;
                    document.body.appendChild(div);
                    toast = document.querySelector('.toast');
                    let numberEntered = document.querySelector('#checkNumber').value.trim();
                    var InvalidEvent = {
                        'Invalid Number Entered': numberEntered,
                    }
                    mixpanelEvent('Invalid Number Checked', InvalidEvent)
                    setTimeout(() => {
                        toast.classList.add('active');
                    }, 100);
                    return
                }

                //fetch numbers only if number is valid
                else if (finalInputNum.length < 20) {
                    payload = {
                        number: finalInputNum
                    }
                    checkError = false;
                    loader.classList.add('d-block');
                    //https://uat.inboxsure.com/ will replace api below later
                    fetch('https://uat.safefamilyapp.com/get-numbers', {
                        method: 'POST', // or 'PUT'
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(payload),
                    })
                        .then((response) => {
                            searchResults.classList.add('collapsing');
                            if (response.ok == true) {
                                return response.json();
                            }
                            return Promise.reject(response); // 2. reject instead of throw
                        })
                        .then(resp => {
                            searchResults.style.filter = "blur(0)";
                            loadData(resp, parentElm);
                            loader.classList.remove('d-block');
                            searchResults.classList.add('show');
                            this.dataset.target = "#search-results";
                            this.dataset.toggle = "collapse";
                            if (resp.length == 0 && searchNum) {
                                searchFooter?.classList.add('d-none');
                            }
                            searchResults.style.height = searchResults.scrollHeight + "px";

                        })
                        .catch((error) => {
                            let parentClass = e.target.closest('.search-form');
                            console.error('Error:', error);
                            setTimeout(() => {
                                searchResults.classList.add('show');
                                searchResults.classList.remove('d-none');
                                loader.classList.remove('d-block');
                                searchResults.classList.add('collapsing');
                                this.dataset.target = "#search-results";
                                this.dataset.toggle = "collapse";
                                cardNum.innerHTML += `<div class="grid-item-full text-center p-3">${failedToFetch}</div>`
                                searchResults.style.height = searchResults.scrollHeight + "px";
                            }, 1000);

                        });

                }

            })
            //fetch API for number porting
            var selectPortType = document.querySelector("#portType");
            var selectedDestination;
            checkPortingBtn && checkPortingBtn.addEventListener('click', async function (e) {
                var country = iti.getSelectedCountryData().iso2.toUpperCase(),
                    portType = selectPortType.options[selectPortType.selectedIndex].value;
                portTypeText = selectPortType.options[selectPortType.selectedIndex].text;
                parentForm = e.target.closest('.search-form');
                e.preventDefault();
                cardResult.innerHTML = "";
                searchResults.style.height = "0";
                if (inputNumberPorting.value.trim() === "" || inputNumberPorting.value === "" || inputNumberPorting.value === null) {
                    if (!checkPortingError) {
                        inputNumberPorting.classList.add('error');
                        searchResults.classList.add('d-none');
                        span = document.createElement('span');
                        span.classList = "text-error block-absolute";
                        span.innerText = 'This field is required';
                        isertAfter(inputNumberPorting, span);
                        setTimeout(() => {
                            document.querySelector('.text-error').classList.add('show');
                        }, 100);
                    }
                    checkPortingError = true;
                    return
                }
                if (portType == 'Select Type' || portType == '') {
                    // delay(document.querySelector('.error-box').classList.add('show'), 1000);
                    setTimeout(async () => {
                        await selectPortType.nextSibling.classList.add('error-box');
                        errorBox = await document.querySelector('.error-box');
                        span = document.createElement('span');
                        span.classList = "text-error block-absolute";
                        span.innerText = 'This field is required';
                        isertAfter(errorBox, span);
                        parentForm.querySelector('.text-error').classList.add('show');
                        parentForm.querySelector('.text-error').style.cssText = `top: 109%; z-index: 1; left:3px`;
                    }, 100);
                    return
                }


                // var selectedCountry =  iti.getSelectedCountryData().iso2.toUpperCase(),
                var isValidPhone,
                    payload = {};

                //trim and remove spaces from value
                var refinedNumber = inputNumberPorting.value.replace(/[^\d\+]/g, '');
                payload = {
                    number: refinedNumber
                }
                // phoneRe.test(refinedNumber);
                var isValidPhone = /^(1\s|1|)?((\(\d{3}\))|\d{3})(\-|\s)?(\d{3})(\-|\s)?(\d{4})$/.test(refinedNumber);
                // const isValid= /^\+?[\d ]+/
                // var validateNum = /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/.test(refinedNumber);
                var validateNum = /^\+?[\d ]+([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{3})$/.test(refinedNumber);
                const plusValid = isValid.test(refinedNumber)
                // alert(validateNum);

                if (plusValid === false || validateNum === false || refinedNumber.length >= 20) {
                    const parentTarget = e.target.closest('.search-form')
                    let checkTextError = parentTarget.querySelector('.text-error')
                    cardResult.classList.remove('mt-4', 'pt-2');
                    if (checkTextError !== null) {
                        return
                    }
                    // cardNum.classList.add('d-none');
                    searchResults.classList.remove('mt-4')
                    div = document.createElement('div');
                    div.classList = "toast";

                    msg = `
                        <div class="toast-content d-flex align-items-center">
                            <span class="icon icon-xs mr-1">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <g clip-path="url(#clip0_7653_560372)">
                                    <path d="M10.7218 2.50061L18.6602 16.2506C18.7333 16.3773 18.7718 16.521 18.7718 16.6673C18.7718 16.8136 18.7333 16.9573 18.6602 17.0839C18.587 17.2106 18.4818 17.3158 18.3552 17.389C18.2285 17.4621 18.0848 17.5006 17.9385 17.5006H2.06183C1.91555 17.5006 1.77185 17.4621 1.64517 17.389C1.51849 17.3158 1.41329 17.2106 1.34016 17.0839C1.26702 16.9573 1.22851 16.8136 1.22852 16.6673C1.22852 16.521 1.26702 16.3773 1.34016 16.2506L9.27849 2.50061C9.35164 2.37394 9.45683 2.26875 9.58351 2.19562C9.71019 2.12249 9.85389 2.08398 10.0002 2.08398C10.1464 2.08398 10.2901 2.12249 10.4168 2.19562C10.5435 2.26875 10.6487 2.37394 10.7218 2.50061V2.50061ZM9.16683 13.3339V15.0006H10.8335V13.3339H9.16683ZM9.16683 7.50061V11.6673H10.8335V7.50061H9.16683Z" fill="#E07408"/>
                                    </g>
                                    <defs>
                                    <clipPath id="clip0_7653_560372">
                                    <rect width="20" height="20" fill="white"/>
                                    </clipPath>
                                    </defs>
                                </svg>
                            </span>
                            <div class="message">
                                <span class="text text-12 text-900"> Number is invalid</span>
                            </div>
                        </div>`
                    div.innerHTML = msg;
                    document.body.appendChild(div);
                    toast = document.querySelector('.toast');
                    // toast.classList.add('active');
                    setTimeout(() => {
                        toast.classList.add('active');
                    }, 100);
                    setTimeout(() => {
                        toast.classList.remove('active');
                    }, 3000);
                    return
                }

                //fetch numbers only if number is valid
                else if (refinedNumber.length < 20) {
                    payload = {
                        number: refinedNumber
                    }
                    checkPortingError = false;
                    loader.classList.add('d-block');
                    //https://uat.inboxsure.com/ will replace api below later
                    fetch('https://uat.safefamilyapp.com/get-numbers', {
                        method: 'POST', // or 'PUT'
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(payload),
                    })
                        .then((response) => {
                            searchResults.classList.add('collapsing');
                            if (response.ok == true) {
                                return response.json();
                            }
                            return Promise.reject(response); // 2. reject instead of throw
                        })
                        .then(resp => {
                            searchResults.style.filter = "blur(0)";
                            checkPortingData(resp, portTypeText);
                            loader.classList.remove('d-block');
                            searchResults.classList.add('show');
                            // selectedList.innerHTML = "";
                            this.dataset.target = "#search-results";
                            this.dataset.toggle = "collapse";
                            if (resp.length == 0 && searchNum) {
                                searchFooter?.classList.add('d-none');
                            }
                            searchResults.style.height = searchResults.scrollHeight + "px";
                        })
                        .catch((error) => {
                            let errorText = parentForm.querySelector('.grid-item-full');
                            console.error('Error:', error);
                            searchResults.classList.add('show');
                            searchResults.classList.remove('d-none');
                            loader.classList.remove('d-block');
                            searchResults.classList.add('collapsing');
                            this.dataset.target = "#search-results";
                            this.dataset.toggle = "collapse";
                            if (errorText == null) {
                                cardNum.innerHTML += `<div class="border-top grid-item-full text-center p-3">${failedToFetch}</div>`
                            }
                            searchResults.style.height = searchResults.scrollHeight + "px";

                            setTimeout(() => {
                                cardNum.classList.remove('d-none');
                                cardNum.classList.remove('mt-4');
                            }, 2000);
                        });

                }

            })
            if (selectPortType) {
                selectPortType.onchange = e => {
                    let parentElm = e.target.parentElement;
                    errorBox = parentElm.querySelector('.error-box');
                    errorText = parentElm.querySelector('.text-error');
                    errorBox && errorBox.classList.remove('error-box');
                    errorText && errorText.remove();



                }
            }
            //Initialize country list for Phone Number Availablity Checker
            if (inputNumber !== null) {
                var itiFlag = window.intlTelInput(inputNumber, {
                    separateDialCode: true,
                    onlyCountries: ["ar", "au", "at", "ba", "bb", "be", "bj", "br", "bg", "ca",
                        "cl", "co", "cz", "de", "dk", "dz", "ec", "ee", "fi", "fr", "gb", "gh", "gd", "gr",
                        "hk", "hr", "hu", "is", "id", "ie", "il", "jm", "ke", "ky", "lt", "mo", "ml", "mu",
                        "mx", "my", "na", "nl", "nz", "pa", "pe", "ph", "pl", "pt", "pr", "ro", "sg", "si", "sk", "sv",
                        "za", "se", "ch", "th", "tn", "tt", "us", "ug", "vz"], //Show only selected country
                    initialCountry: cnIso // INITIAL SELECTED COUNTRY

                });
            }
            // inputNumber = (inputNumber == null && inputNumberPorting !== null)? inputNumberPorting : inputNumber;
            var checkError = false,
                checkPortingError = false,
                isValid = /^\+?[\d ]+/;
            //Allow only phone num and copy paste number if id exist

            if (inputNumber == null && inputNumberPorting !== null) {
                inputNumber = inputNumberPorting
            }
            if (inputNumber !== null) {
                //Allow only phone num
                inputNumber.addEventListener("keypress", function (evt) {
                    let parentTarget = evt.target.closest('.check-num');
                    checkError = false;
                    errorText = parentTarget.querySelector('.text-error');
                    inputNumber.classList.remove('error');
                    errorText && errorText.remove();
                    var ASCIICode = (evt.which) ? evt.which : evt.keyCode
                    if (ASCIICode > 31 && (ASCIICode != 32 && ASCIICode != 43 && (ASCIICode < 48 || ASCIICode > 57))) {
                        evt.preventDefault();
                    }
                });
                'input:-webkit-autofill'
                // Not to allow copy paste text in number feild
                inputNumber.onpaste = e => {
                    let parentTarget = e.target.closest('.check-num');
                    errorText = parentTarget.querySelector('.text-error');
                    if (errorText) {
                        checkError = false;
                        inputNumber.classList.remove('error');
                        errorText.remove();
                    }
                    setTimeout(function () {
                        const value = e.target.value.trim();
                        if (!isValid.test(value)) {
                            return e.target.value = ""
                        }
                    }, 100)
                };

                // onchange fuinction for availability checker
                inputNumber.addEventListener("countrychange", function (e) {
                    var newErrorText = document.querySelector('.search-form .text-error');
                    if (newErrorText) {
                        checkError = false;
                        inputNumber.classList.remove('error');
                        newErrorText.remove();
                    }
                    setTimeout(function () {
                        const value = e.target.value.trim()
                        if (!isValid.test(value)) {
                            return e.target.value = ""
                        }
                    }, 100)
                });
                inputNumber.onchange = e => {
                    let parentTarget = e.target.closest('.check-num');
                    var newErrorText = parentTarget.querySelector('.text-error');
                    if (newErrorText) {
                        checkError = false;
                        inputNumber.classList.remove('error');
                        newErrorText.remove();
                    }
                    setTimeout(function () {
                        const value = e.target.value.trim()
                        if (!isValid.test(value)) {
                            return e.target.value = ""
                        }
                    }, 100)
                };

            }
            //Locality dropdown event listener
            selectedArea && selectedArea.addEventListener('change', function () {
                searchResults.style.filter = "blur(3px)";
                searchResults.classList.remove('mt-5');
                searchResults.style.height = "0";
            })

            // Change function on Inbound selection country
            selectCountryInbound && selectCountryInbound.addEventListener("countrychange", function (e) {
                let parentElm = e.target.closest('.search-rates');
                let countryFlagContainer = document.querySelectorAll('.iti__selected-flag');
                let searchResults = parentElm.querySelectorAll('.search-results');
                let selectCountryList = document.querySelectorAll('.select-country');
                let searchResultsArr = Array.from(searchResults);
                updateField(intlInboundInput, '.table-inbound');
                tr = document.createElement('tr');
                td = document.createElement('td');
                td.setAttribute('colspan', '3');
                td.setAttribute('align', 'center');
                span = document.createElement('span');
                span.classList = 'preloader preloader-sm d-block';
                td.appendChild(span);
                tr.appendChild(td);
                let changedInboundCountry = intlInboundInput.getSelectedCountryData().iso2.toUpperCase();
                let changedOutboundCountry = intlOutboundInput.getSelectedCountryData().iso2.toUpperCase();
                // countryFlagContainer.style.opacity = '1';
                Array.from(countryFlagContainer).forEach((el, t) => {
                    let countryFlag = el.querySelector('.iti__flag');
                    let countryDialCode = el.querySelector('.iti__selected-dial-code');
                    countryFlag.style.opacity = '1';
                    countryDialCode.style.opacity = '1';
                })
                Array.from(selectCountryList).forEach((el, t) => {
                    let targetInput = el.querySelector('input');
                    targetInput.style.opacity = '0'
                });

                searchResultsArr.forEach((el, i) => {
                    let tbody = el.querySelector('table tbody');
                    if (i == 0) {
                        td = td.setAttribute('colspan', '4');
                    };
                    tbody.appendChild(tr.cloneNode(true));
                    el.classList.add('show');
                    el.classList.add('collapsing');
                    el.style.height = el.scrollHeight + "px";
                })
                let newData = {
                    country: changedInboundCountry,
                    destination: changedOutboundCountry

                };
                fetch('https://uat.safefamilyapp.com/get-prices', {
                    method: 'POST', // or 'PUT'
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(newData),
                })
                    .then((response) => {
                        if (response.ok == true) {
                            return response.json();
                        }
                        return Promise.reject(response); // 2. reject instead of throw
                    })
                    .then(resp => {
                        if (!Array.isArray(resp.types)) {

                            searchResultsArr.forEach((el) => {
                                let tbody = el.querySelector('table tbody');
                                var newTD = `<tr><td colspan='4' style="text-align:center" align='center'>${resp.error}</td></tr>`
                                tbody.innerHTML = newTD;
                                el.style.height = "auto";

                            })
                            return;
                        }
                        // debugger;
                        selectedDestination = newData.country;
                        searchResultsArr.forEach((el) => {
                            let tbody = el.querySelector('table tbody');
                            tbody.innerHTML = "";
                        })
                        loadData(resp, parentElm);
                        tableOutbound.classList.add('show');
                        for (let result of searchResults) {
                            result.style.height = 'auto';
                            result.classList.add('show');
                        }
                    })
                    .catch((error) => {
                        console.error('Error:', error);
                    });
            })
            // Change function on Outbound selection country
            selectCountryOutbound && selectCountryOutbound.addEventListener("countrychange", function (e) {
                let parentElm = e.target.closest('.search-rates');
                let searchResults = parentElm.querySelectorAll('.search-results');
                let searchResultsArr = Array.from(searchResults);
                updateField(intlOutboundInput, '.table-outbound');
                tr = document.createElement('tr');
                td = document.createElement('td');
                td.setAttribute('colspan', '3');
                td.setAttribute('align', 'center');
                span = document.createElement('span');
                span.classList = 'preloader preloader-sm d-block';
                td.appendChild(span);
                tr.appendChild(td);
                searchResultsArr.forEach((el, i) => {
                    let tbody = el.querySelector('table tbody');
                    if (i == 0) {
                        td = td.setAttribute('colspan', '4');
                    };
                    tbody.appendChild(tr.cloneNode(true));
                    el.classList.add('show');
                    el.classList.add('collapsing');
                    el.style.height = el.scrollHeight + "px";
                })
                let changedInboundCountry = intlInboundInput.getSelectedCountryData().iso2.toUpperCase();
                let changedOutboundCountry = intlOutboundInput.getSelectedCountryData().iso2.toUpperCase();

                let newData = {
                    country: changedInboundCountry,
                    destination: changedOutboundCountry
                };
                fetch('https://uat.safefamilyapp.com/get-prices', {
                    method: 'POST', // or 'PUT'
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(newData),
                })
                    .then((response) => {
                        if (response.ok == true) {
                            return response.json();
                        }
                        return Promise.reject(response); // 2. reject instead of throw
                    })
                    .then(resp => {
                        if (!Array.isArray(resp.types)) {
                            searchResultsArr.forEach((el, i) => {
                                let tbody = el.querySelector('table tbody');
                                var newTD = `<tr><td colspan='3' style="text-align:center" align='center'>${resp.error}</td></tr>`
                                if (i == 0) {
                                    newTD = `<tr><td colspan='4' style="text-align:center" align='center'>${resp.error}</td></tr>`
                                };
                                tbody.innerHTML = newTD;
                                el.style.height = "auto";
                            })
                            return;
                        }
                        // debugger;

                        selectedDestination = newData.destination;
                        searchResultsArr.forEach((el) => {
                            let tbody = el.querySelector('table tbody');
                            tbody.innerHTML = "";
                        })
                        loadData(resp, parentElm);
                        for (let result of searchResults) {
                            result.style.height = "auto";
                            result.classList.add('show');
                        }
                    })
                    .catch((error) => {
                        console.error('Error:', error);
                    });

            })


            //collapse function on click function
            function collapse() {
                setTimeout(function () {
                    searchResults.style.cssText = 'height: 0';
                    searchResults.classList.add('m-0');
                    searchResults.classList.remove('mt-5');
                }, 100);
                setTimeout(function () {
                    searchResults.classList.remove('m-0');
                    $crisp.push(['do', 'chat:open']);
                }, 200);
            }
            // function to load data on cards
            function loadData(resp, parentElm) {
                var contentInfoRow = parentElm.querySelector('.search-results .row'),
                    searchResultsGrid = parentElm.querySelector('.d-grid'),
                    searchResultsGridTwo = parentElm.querySelector('.d-grid-2'),
                    searchResultTwoCol = parentElm.classList.contains('two-col'),
                    searchResultsInfoRow = parentElm.querySelector('.search-results');
                if (resp.length == 1 && checkNum) {
                    cardNum.innerHTML = '';
                    searchResults.classList.add('mt-3');
                    for (var i = 0; i < resp.length; i++) {
                        availableNumber(resp[i])
                    }
                    cardNum.classList.remove('d-none');
                    searchResults.classList.remove('d-none');
                }
                else if (resp.length > 0 && searchNum) {
                    cardNum.innerHTML = '';
                    cardNum?.classList.remove('d-none');
                    searchResultsGrid?.classList.add('d-grid-4');
                    const hasClassBlock = searchResultsGridTwo?.classList.contains('d-block');
                    if (hasClassBlock) {
                        searchResultsGridTwo?.classList.remove('d-block');
                    }
                    searchResultsInfoRow?.classList.remove('d-none');
                    contentInfoRow?.classList.remove('d-none');
                    !searchResultTwoCol && searchResults.classList.add('mt-5');
                    if (selectedListTable) {
                        numberListTable(resp);
                    }
                    else {
                        for (var i = 0; i < resp.length; i++) {
                            selectedNumber(resp[i])
                        }
                    }
                }
                else if (resp?.types?.length > 0 && tableOutbound) {
                    for (var i = 0; i < resp?.types?.length; i++) {
                        checkTypeRates(resp?.types[i], resp.outbound_sms_price, parentElm)
                    }
                }
                else if (resp.length > 1 && checkNum) {
                    cardNum.innerHTML = '';
                    searchResults.classList.add('mt-3');
                    let similarRes = resp.slice(0, 6);
                    cardNum.classList.remove('d-none');
                    searchResults.classList.remove('d-none');
                    numberListTable(similarRes);
                }
                else if (resp.length == 0 && searchNum) {
                    contentInfoRow?.classList.add('d-none');
                    cardNum.innerHTML = noMatchFound;
                    searchResultsGrid?.classList.remove('d-grid-4');
                    cardNum?.classList.add('d-block');
                }
                else {
                    cardNum.innerHTML = '';
                    searchResults.classList.add('mt-3');
                    noMatch();
                }
            }
            // check porting number
            function checkPortingData(resp, portType) {
                cardResult.innerHTML = '';
                if (resp.length > 0) {
                    searchResults.classList.add('mt-4');
                    availablePorting(resp[0], portType);
                    searchResults.classList.remove('d-none');
                }
                else {
                    cardResult.classList.remove('d-none');
                    searchResults.classList.remove('d-none');
                    cardResult.innerHTML += `<span>Sorry! Number not available</span>`
                    searchResults.style.height = searchResults.scrollHeight + "px";
                    searchResults.classList.add('mt-4');
                    setTimeout(() => {
                        searchResults.style.height = "0";
                        cardResult.innerHTML = '';
                    }, 2500);
                    setTimeout(() => {
                        searchResults.classList.remove('mt-4');
                    }, 2500);
                }
            }
            var porting = [
                {
                    'country': 'Australia',
                    'local': true,
                    'mobile': true,
                    'tollfree': true,
                },
                {
                    'country': 'Austria',
                    'local': true,
                    'mobile': false,
                    'tollfree': true,
                },
                {
                    'country': 'Belgium',
                    'local': true,
                    'mobile': true,
                    'tollfree': true,
                },
                {
                    'country': 'Brazil',
                    'local': true,
                    'mobile': false,
                    'tollfree': true,
                },
                {
                    'country': 'Canada',
                    'local': true,
                    'mobile': true,
                    'tollfree': true,
                },
                {
                    'country': 'Czech Republic',
                    'local': true,
                    'mobile': false,
                    'tollfree': true,
                },
                {
                    'country': 'Denmark',
                    'local': true,
                    'mobile': false,
                    'tollfree': true,
                },
                {
                    'country': 'Finland',
                    'local': true,
                    'mobile': true,
                    'tollfree': true,
                },
                {
                    'country': 'France',
                    'local': true,
                    'mobile': false,
                    'tollfree': false,
                },
                {
                    'country': 'Germany',
                    'local': true,
                    'mobile': false,
                    'tollfree': true,
                },
                {
                    'country': 'Ireland',
                    'local': true,
                    'mobile': false,
                    'tollfree': true,
                },
                {
                    'country': 'Italy',
                    'local': true,
                    'mobile': false,
                    'tollfree': false,
                },
                {
                    'country': 'Luxembourg',
                    'local': true,
                    'mobile': false,
                    'tollfree': true,
                },
                {
                    'country': 'Mexico',
                    'local': true,
                    'mobile': false,
                    'tollfree': true,
                },
                {
                    'country': 'Netherlands',
                    'local': true,
                    'mobile': false,
                    'tollfree': false,
                },
                {
                    'country': 'New Zealand',
                    'local': true,
                    'mobile': false,
                    'tollfree': true,
                },
                {
                    'country': 'Norway',
                    'local': true,
                    'mobile': false,
                    'tollfree': false,
                },
                {
                    'country': 'Portugal',
                    'local': false,
                    'mobile': false,
                    'tollfree': true,
                },
                {
                    'country': 'Puerto Rico',
                    'local': true,
                    'mobile': false,
                    'tollfree': false,
                },
                {
                    'country': 'Romania',
                    'local': false,
                    'mobile': false,
                    'tollfree': false,
                },
                {
                    'country': 'Slovenia',
                    'local': true,
                    'mobile': false,
                    'tollfree': false,
                },
                {
                    'country': 'Spain',
                    'local': true,
                    'mobile': false,
                    'tollfree': true,
                },
                {
                    'country': 'Switzerland',
                    'local': true,
                    'mobile': false,
                    'tollfree': false,
                },
                {
                    'country': 'United Kingdom',
                    'local': true,
                    'mobile': true,
                    'tollfree': true,
                },
                {
                    'country': 'United States',
                    'local': true,
                    'mobile': true,
                    'tollfree': true,
                },
            ];
            function availablePorting(num, portType) {
                var str = num.country_iso.toLowerCase(),
                    documentRequired = (num.address_requirements == "any" || num.address_requirements == "local") ? "Yes" : "No",
                    portingType = document.querySelector('#portType').value.toLowerCase(),
                    availableCn,
                    cardColor,
                    numberPortingAvailability = "";
                countryList.map(c => {
                    var iso = new String(c.iso2);
                    if (iso.trim() === str) {
                        availableCn = c.name
                        let selectedCountry = porting.find(p => {
                            return availableCn.includes(p.country)
                        }
                        )
                        const isNumberPortingType = selectedCountry ? selectedCountry[portingType] : false;
                        numberPortingAvailability = isNumberPortingType ? 'Available' : 'not Available';
                        cardColor = isNumberPortingType ? 'success' : 'danger';
                        var card = `<div class="card">
                                        <div class="text-center text-700">
                                            <h4>
                                                Number Porting Results
                                            </h4>
                                            <div class="card--${cardColor} mt-3 border-r-4">
                                                <p>
                                                ${isNumberPortingType ? 'Congratulations!' : 'Sorry!'} Number Porting is <strong>${numberPortingAvailability}</strong>
                                                </p>
                                            </div>
                                        </div>
                                        <div class="card-details text-700">
                                            <ul class="text-left pl-0 row flex-column">
                                                <li class="d-flex">
                                                    <span class="col text-600">Country:</span>
                                                    <span class="col-auto text-700">${availableCn}</span>
                                                </li>
                                                <li class="d-flex">
                                                    <span class="col text-600">Type:</span>
                                                    <span class="col-auto text-700">${portType}</span>
                                                </li>
                                                ${isNumberPortingType ?
                                `<li class="d-flex">
                                                    <span class="col text-600">Document Required:</span>
                                                    <span class="col-auto text-700">${documentRequired}</span>
                                                </li>`: ''
                            }
    
                                            </ul>
                                        </div>
                                    </div>
    
                            `
                        if (isNumberPortingType)
                            card += `
                                    <div class="mb-3 p-0 card bg-transparent"><input class="form-control border" type="email" id="portingEmail" placeholder="Enter your email"></div>
                                        <div class="card bg-white p-0">
                                        <button class="btn btn-success btn-proceed w-100">Proceed Porting<span class="preloader preloader-xs"></span></button>
                                    </div>
                            `
                        cardResult.innerHTML += card
                    }
                })

                var btnProceed = document.querySelector('.btn-proceed');
                btnProceed?.addEventListener('click', e => proceedPorting(e, availableCn, portType, documentRequired));

            }
            var checkStatus = false;
            function proceedPorting(e, country, portType, documentRequired) {
                e.preventDefault();
                var portingEmail = document.querySelector('#portingEmail'),
                    portingNum = document.getElementById('checkNumberPorting');
                var fstatus;
                postUrl = 'https://krispcall-sendgrid-x5644.ondigitalocean.app/api/sendgridemail/porting'
                let data = {
                    "list_ids": ["87b36c03-ea96-493c-91ee-38534e84eb7a"],
                    "contacts": [
                        {
                            "email": portingEmail.value,
                            "phone_number": portingNum.value,
                            "country": country,
                            "custom_fields":
                            {
                                "w13_T": portType,
                            }
                        }
                    ]
                }

                portingLoader = document.querySelector('.btn-proceed .preloader');
                var mailformat = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
                let validEmail = portingEmail.value.match(mailformat)
                if (!validEmail) {
                    if (!checkStatus) {
                        portingEmail.classList.add('error');
                        span = document.createElement('span');
                        span.classList = "text-error block-absolute";
                        span.innerText = 'This field is required';
                        isertAfter(portingEmail, span);
                        searchResults.style.height = searchResults.scrollHeight + "px";
                        setTimeout(() => {
                            document.querySelector('.text-error').classList.add('show');

                        }, 100);

                    }
                    checkStatus = true;
                    return
                }
                if (portingEmail !== "") {
                    let errorText = document.querySelector('.search-form .text-error');
                    const webhookData = {
                        email: portingEmail.value,
                        phone_type: portType,
                        number: portingNum.value,
                        country: country,
                        documentRequired: documentRequired,
                    }
                    portingEmail && portingEmail.classList.remove('error');
                    errorText && errorText.remove();
                    portingLoader.classList.add('d-block');
                    $.ajax({
                        type: 'POST',
                        url: postUrl,
                        data: JSON.stringify(data),
                        dataType: 'json',
                        crossDomain: true,
                        contentType: 'application/json',
                        secure: true,
                        success: function (callback) {
                            if (callback.status == 'success') {
                                portingLoader.remove('d-block');
                                searchResults.style.height = "0";
                                cardResult.innerHTML = '';
                                portingNum.value = '';
                                setTimeout(() => {
                                    cardResult.innerHTML = `<div class="card card-transparent"><span class="card--success border-r-4 text-center"><strong>Thanks for proceeding.</strong><br/> Our sales representative will soon contact you via email.</span></div>`;
                                    searchResults.style.height = searchResults.scrollHeight + "px";
                                }, 500);
                                fetch('https://hook.eu1.make.com/80tfhpwnowb1zn3aqg9clh84sag8gs2t', {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json',
                                    },
                                    body: JSON.stringify(webhookData)
                                })
                                    .catch(error => {
                                        console.error('Error:', error);
                                    });

                            } else {
                                cardResult.innerHTML = '<span>Sending failed</span>';
                            }
                        }

                    })

                }
            }

            // Convert to Sentence case
            function toSentenceCase(str) {
                return str.toLowerCase().charAt(0).toUpperCase() + str.slice(1);;
            }
            // Price Inbound/Outbound
            function checkTypeRates(resp, outboundSMSPrice, parentElm) {
                const showOutboundRateForUS = toSentenceCase(resp?.type) == 'Local' && selectedDestination == "US";
                const showOutboundRateForMobile = toSentenceCase(resp?.type) == 'Mobile';

                const isMobileType = (toSentenceCase(resp?.type) == 'Mobile');
                let InboundTbody = parentElm.querySelector('.table-inbound .table tbody');
                let OutboundTbody = parentElm.querySelector('.table-outbound .table tbody');
                let searchResults = parentElm.querySelector('.search-results');
                const renderInboundRateList = `
                    <tr>
                        <td>${toSentenceCase(resp?.type)}</td>
                        <td>${resp?.num_price || '-'}</td>
                        <td>${resp?.inbound_call_price?.toFixed(2) || '-'}</td>
                        <td>${resp?.inbound_sms_price?.toFixed(2) || '-'}</td>
                    </tr>
                `;
                const renderOutboundRateList = `
                    <tr>
                    <td>${toSentenceCase(resp?.type)}</td>
                    <td>${resp?.outbound_call_price || '-'}</td>
                    <td>${showOutboundRateForMobile || showOutboundRateForUS ? 'Starting from ' + outboundSMSPrice?.toFixed(2) : '-'}</td>
                
                    </tr>
                `;
                InboundTbody.innerHTML += renderInboundRateList;
                OutboundTbody.innerHTML += renderOutboundRateList;
                searchResults.style.height = 'auto';
            }

            // check avaiable number
            function availableNumber(num) {
                let numberEntered = document.querySelector('#checkNumber').value.trim();
                var str = num.country_iso.toLowerCase();
                var availableCn;
                var availableEvent = {
                    'Number Entered': numberEntered,
                }
                let siblings = n => [...n.parentElement.children].filter(c => c == n),
                    c_flag = document.querySelector('.check-num .iti__flag'),
                    ele = siblings(c_flag);

                countryList.map(c => {
                    var iso = new String(c.iso2);
                    if (iso.trim() === str) {
                        availableCn = c.name
                    }
                })
                documentRequired = (num?.address_requirements == "any" || num?.address_requirements == "local") ? "Yes" : "No";
                var card = `<div class="alert alert-success media w-100" role="alert">
                                <span class="icon mr-2">
                                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <g clip-path="url(#clip0_1001_47166)">
                                        <path d="M10.0001 18.3327C5.39758 18.3327 1.66675 14.6018 1.66675 9.99935C1.66675 5.39685 5.39758 1.66602 10.0001 1.66602C14.6026 1.66602 18.3334 5.39685 18.3334 9.99935C18.3334 14.6018 14.6026 18.3327 10.0001 18.3327ZM9.16925 13.3327L15.0609 7.44018L13.8826 6.26185L9.16925 10.976L6.81175 8.61852L5.63341 9.79685L9.16925 13.3327Z" fill="#4C9610"/>
                                        </g>
                                        <defs>
                                        <clipPath id="clip0_1001_47166">
                                        <rect width="20" height="20" fill="white"/>
                                        </clipPath>
                                        </defs>
                                    </svg>
                                </span>
                                <div class="media-body text-600 text-left">
                                    <span class="text-800"><b>Number Available</b></span>
                                    <p>Congratulation, the number <strong>${num?.dialing_number}</strong> is available on KrispCall.</p>
                                </div>
                            </div>
                            <div class="card bg-transparent p-0 max-w-100">
                                <div class="card-details card-details--table text-700">
                                    <ul class="text-left pl-0 row flex-column">
                                        <li class="d-flex">
                                            <span class="col text-600">Country</span>
                                            <div class="wrapper-country">
                                                <span class="${ele[0].className}"></span>
                                                <span class="col-auto text-700 pl-1">${availableCn}</span>
                                            </div>
                                        </li>
                                        <li class="d-flex">
                                            <span class="col text-600">Type</span>
                                            <span class="col-auto text-700">${num?.type}</span>
                                        </li>
                                        <li class="d-flex">
                                            <span class="col text-600">Document Required</span>
                                            <span class="col-auto text-700">${documentRequired}</span>
                                        </li>
                                        <li class="d-flex">
                                            <span class="col text-600">Number Cost</span>
                                            <span class="col-auto text-700">$${num?.price} + <a href="/pricing/" class="tag tag-outline bg-white text-underline text-info">Subscription fee</a></span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <a href="https://app.krispcall.com/register" target="_blank" class="btn btn-success w-100">Sign up & Purchase Now</a>
    
                    `
                cardNum.innerHTML += card;
                availableEvent['Available Number'] = num?.dialing_number;
                mixpanelEvent('Number Availability Checked', availableEvent)
            }
            // check unavaiable number
            function numberListTable(num) {
                if (checkBtn) {
                    let numberEntered = document.querySelector('#checkNumber').value.trim();
                    const unavailableEvent = {
                        'Number Entered': numberEntered,
                    }
                    var card = `<div class="alert alert-warning media w-100" role="alert">
                                    <span class="icon mr-2">
                                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <g clip-path="url(#clip0_7653_560372)">
                                            <path d="M10.7218 2.50061L18.6602 16.2506C18.7333 16.3773 18.7718 16.521 18.7718 16.6673C18.7718 16.8136 18.7333 16.9573 18.6602 17.0839C18.587 17.2106 18.4818 17.3158 18.3552 17.389C18.2285 17.4621 18.0848 17.5006 17.9385 17.5006H2.06183C1.91555 17.5006 1.77185 17.4621 1.64517 17.389C1.51849 17.3158 1.41329 17.2106 1.34016 17.0839C1.26702 16.9573 1.22851 16.8136 1.22852 16.6673C1.22852 16.521 1.26702 16.3773 1.34016 16.2506L9.27849 2.50061C9.35164 2.37394 9.45683 2.26875 9.58351 2.19562C9.71019 2.12249 9.85389 2.08398 10.0002 2.08398C10.1464 2.08398 10.2901 2.12249 10.4168 2.19562C10.5435 2.26875 10.6487 2.37394 10.7218 2.50061V2.50061ZM9.16683 13.3339V15.0006H10.8335V13.3339H9.16683ZM9.16683 7.50061V11.6673H10.8335V7.50061H9.16683Z" fill="#E07408"/>
                                            </g>
                                            <defs>
                                            <clipPath id="clip0_7653_560372">
                                            <rect width="20" height="20" fill="white"/>
                                            </clipPath>
                                            </defs>
                                        </svg>
                                    </span>
                                    <div class="media-body text-600 text-left">
                                        <span class="text-800"><b>Number Unavailable</b></span>
                                        <p>The entered number could not be found. Please ensure that you have entered the correct number and try again.</p>
                                    </div>
                                </div>
                                <div class="card-table card-details--table border-0 d-none">
                                    <p><strong>Note:</strong> You can consider the following numbers with similar capabilities.</p>
                                    <table class="table-radius mt-2 bg-white">
                                    <thead>
                                        <tr>
                                            <th>Numbers</th>
                                            <th>Ability</th>
                                            <th>Type</th>
                                            <th>Monthly Fee</th>
                                        </tr>
                                    </thead>
                                        <tbody>`
                    num.map((list, i) => {
                        var iso = list.country_iso.toLowerCase();
                        var propertyName = 'Similar Phone Number ' + (i + 1);
                        unavailableEvent[propertyName] = list.dialing_number;
                        card += `<tr>
                                                    <td>
                                                        <table>
                                                            <tr class="border-none">
                                                                <td class="p-0">
                                                                    <span class="icon-circle border-100 icon-md"><span class="iti__flag iti__${iso}"></span></span>
                                                                </td>
                                                                <td class="p-0">
                                                                    ${list.dialing_number}
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                    <td>
                                                        <table>
                                                            <tr class="border-none">`
                        if (list.capabilities.voice === true) {
                            card += `
                                                                        <td class="icon icon-voice border-r-4">
                                                                            <span class="icon-xs d-flex align-items-center">
                                                                                Voice
                                                                            </span>
                                                                        </td>`
                        }
                        if (list.capabilities.SMS === true) {
                            card += `
                                                                        <td class="icon icon-sms border-r-4">
                                                                            <span class="icon-xs d-flex align-items-center">
                                                                                SMS
                                                                            </span>
                                                                        </td>`
                        }
                        if (list.capabilities.MMS === true) {
                            card += `
                                                                        <td class="icon icon-mms border-r-4">
                                                                            <span class="icon-xs d-flex align-items-center">
                                                                                MMS
                                                                            </span>
                                                                        </td>`
                        }


                        card += `</tr>
                                                        </table>
                                                    </td>
                                                    <td>${list.type}</td>
                                                    <td>$ ${list.price}</td>
                                                    <td><a href="https://app.krispcall.com/register" class="btn btn-outline-primary">Buy Number</a></td>
                                                    </tr>
                                                    `
                    })
                    card += `
                                        </tbody>
                                    </table>
                                </div>
                                `

                    cardNum.innerHTML += card;

                    mixpanelEvent('Number Unvailability Checked', unavailableEvent)
                }
                if (selectedListTable) {

                    rightMapHeight.style.height = `${searchFormHeight - 36}px`;
                    leftMapHeight.style.height = `${searchFormHeight - 36}px`;
                    var cardList = `
                                    <div class="card-table card-details--table border-0 d-none  d-md-block">
                                       <table class="table-radius mt-2 bg-transparent">
                                        <thead>
                                            <tr>
                                                <th colspan="2">Phone Numbers</th>
                                                <th>Type</th>
                                                <th>Ability</th>
                                                <th>Price</th>
                                                <th class="text-center">Buy</th>
                                            </tr>
                                        </thead>
                                            <tbody>`
                    num.map((list, i) => {
                        var iso = list.country_iso.toLowerCase();
                        var propertyName = 'Similar Phone Number ' + (i + 1);
                        cardList += `<tr>
                                                        <td colspan="2">
                                                            <table>
                                                                <tr class="border-none">
                                                                    <td class="p-0">
                                                                        ${list.dialing_number}
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                        <td><span class='icon btn-type btn-type-${list.type.toLowerCase()}'>${list.type}</span></td>
                                                        <td>
                                                            <table>
                                                                <tr class="border-none">`
                        if (list.capabilities.voice === true) {
                            cardList += `
                                                                            <td class="icon btn-abilities btn-outline-primary-lt border-r-4">
                                                                                <span class="icon-xs d-flex align-items-center">
                                                                                    Call
                                                                                </span>
                                                                            </td>`
                        }
                        if (list.capabilities.SMS === true) {
                            cardList += `
                                                                        <td class="icon btn-abilities btn-outline-primary-lt border-r-4">
                                                                                <span class="icon-xs d-flex align-items-center">
                                                                                    SMS
                                                                                </span>
                                                                            </td>`
                        }
                        if (list.capabilities.MMS === true) {
                            cardList += `
                                                                        <td class="icon btn-abilities btn-outline-primary-lt border-r-4">
                                                                                <span class="icon-xs d-flex align-items-center">
                                                                                    MMS
                                                                                </span>
                                                                            </td>`
                        }


                        cardList += `</tr>
                                                            </table>
                                                        </td>
                                                        <td>$ ${list.price}</td>
                                                        <td><a href="https://app.krispcall.com/register" class="btn btn-primary-lt">Buy</a></td>
                                                        </tr>
                                                        `
                    })
                    cardList += `
                                            </tbody>
                                        </table>
                                        <p class="mt-4">Costing for each number and the subscription for KrispCall platform are different. User will be charged monthly based on numbers they own + subscription fee for KrispCall Platform.</p>
                                    </div>
                                    `

                    var cardListMobile = `<div class="d-block d-md-none">`
                    num.map((list, i) => {
                        cardListMobile += `<div class="card-list d-flex justify-content-between align-items-center">
                                                    <div class="card-list--details">
                                                        <div class="top mb-3 item-center">
                                                        <span class="number">${list.dialing_number}</span>
                                                            <span class="ml-2 btn-type btn-type-${list.type.toLowerCase()}"> ${list.type}</span>
                                                        </div>
                                                        <div class="bottom">`
                        if (list.capabilities.voice === true) {
                            cardListMobile += `
                                                                <span class="btn-abilities btn-outline-primary-lt border-r-4 align-items-center">
                                                                    Call
                                                                </span>`
                        }
                        if (list.capabilities.SMS === true) {
                            cardListMobile += `
                                                                <span class="btn-abilities btn-outline-primary-lt border-r-4 align-items-center">
                                                                    SMS
                                                                </span>`
                        }
                        if (list.capabilities.MMS === true) {
                            cardListMobile += `
                                                                <span class="btn-abilities btn-outline-primary-lt border-r-4 align-items-center">
                                                                        MMS
                                                                </span>`
                        }
                        cardListMobile += `</div>
                                                    </div>
                                                    <div class="card-list--price">
                                                        <div class="price mb-3 text-smbold">$ ${list.price}</div>
                                                        <a href="https://app.krispcall.com/register" class="btn btn-primary-lt">Buy</a>
                                                    </div>
                                                </div>`
                    })
                    cardListMobile += `<p class="mt-4">Costing for each number and the subscription for KrispCall platform are different. User will be charged monthly based on numbers they own + subscription fee for KrispCall Platform.</p>
                                   </div>`


                    cardNum.innerHTML += cardList;
                    cardNum.innerHTML += cardListMobile;



                }

            }
            //No Match Found
            function noMatch() {
                var card = `<div class="alert alert-warning media w-100" role="alert">
                                <span class="icon mr-2">
                                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <g clip-path="url(#clip0_7653_560372)">
                                        <path d="M10.7218 2.50061L18.6602 16.2506C18.7333 16.3773 18.7718 16.521 18.7718 16.6673C18.7718 16.8136 18.7333 16.9573 18.6602 17.0839C18.587 17.2106 18.4818 17.3158 18.3552 17.389C18.2285 17.4621 18.0848 17.5006 17.9385 17.5006H2.06183C1.91555 17.5006 1.77185 17.4621 1.64517 17.389C1.51849 17.3158 1.41329 17.2106 1.34016 17.0839C1.26702 16.9573 1.22851 16.8136 1.22852 16.6673C1.22852 16.521 1.26702 16.3773 1.34016 16.2506L9.27849 2.50061C9.35164 2.37394 9.45683 2.26875 9.58351 2.19562C9.71019 2.12249 9.85389 2.08398 10.0002 2.08398C10.1464 2.08398 10.2901 2.12249 10.4168 2.19562C10.5435 2.26875 10.6487 2.37394 10.7218 2.50061V2.50061ZM9.16683 13.3339V15.0006H10.8335V13.3339H9.16683ZM9.16683 7.50061V11.6673H10.8335V7.50061H9.16683Z" fill="#E07408"/>
                                        </g>
                                        <defs>
                                        <clipPath id="clip0_7653_560372">
                                        <rect width="20" height="20" fill="white"/>
                                        </clipPath>
                                        </defs>
                                    </svg>
                                </span>
                                <div class="media-body text-600 text-left">
                                    <span class="text-800"><b>No Match Found</b></span>
                                    <p>Number acquisition is still possible. For more information, please <a href='mailto:support@krispcall.com' >contact</a> our support team.</p>
                                </div>
                            </div>
                            `
                cardNum.innerHTML += card;
            }

            //Card number list function of selected country
            function selectedNumber(num) {
                var nation = iti.getSelectedCountryData().name,
                    siblings = n => [...n.parentElement.children].filter(c => c == n),
                    c_flag = document.querySelector('.iti__flag'),
                    ele = siblings(c_flag);
                let hasSelectedListClass = cardNum.classList.contains('selected-list');
                if (hasSelectedListClass) {
                    var card = `<div class="card card-sm card-bordered">
                    <div class="i-block block-relative">
                        <div class="i-block__content item-center justify-content-between">
                            <span class="d-inline-block card-num text-8">${num.dialing_number}</span>
                            <span class="tag tag-auto item-center d-inline border-r-4 ml-2">${num.type}</span>
                        </div>
                        <div class="ml-auto text-secondary text-lg-right">
                            <span class="text-9 text-bold">$ ${num.price}</span> <span class="text-12 text-md">+ Subscription fee</span>
                            <ul class="d-flex pl-0 mb-0 mt-1 text-700 list-inline--dot justify-content-lg-end">
                            `
                    if (num.capabilities.voice === true) {
                        card += `
                                    <li>
                                        <div class="icon mr-1">
                                            <div class="icon icon-sm">
                                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd" clip-rule="evenodd" d="M12.8542 4.1467C13.0494 4.34197 13.0494 4.65857 12.8542 4.85385L11.0409 6.66706H11.8339C12.11 6.66706 12.3339 6.89093 12.3339 7.16709C12.3339 7.44324 12.11 7.66711 11.8339 7.66711H9.83377C9.55761 7.66711 9.33374 7.44324 9.33374 7.16709V5.16698C9.33374 4.89082 9.55761 4.66695 9.83377 4.66695C10.1099 4.66695 10.3338 4.89082 10.3338 5.16698V5.95991L12.147 4.1467C12.3423 3.95143 12.6589 3.95143 12.8542 4.1467Z" fill="#666666"/>
                                                <path fill-rule="evenodd" clip-rule="evenodd" d="M12.2391 10.1875C12.0438 9.99226 12.0438 9.67566 12.2391 9.48038L14.0523 7.66717L13.2594 7.66717C12.9832 7.66717 12.7594 7.4433 12.7594 7.16714C12.7594 6.89098 12.9832 6.66711 13.2594 6.66711L15.2595 6.66711C15.5357 6.66711 15.7595 6.89098 15.7595 7.16714L15.7595 9.16725C15.7595 9.44341 15.5357 9.66728 15.2595 9.66728C14.9833 9.66728 14.7595 9.44341 14.7595 9.16725L14.7595 8.37432L12.9463 10.1875C12.751 10.3828 12.4344 10.3828 12.2391 10.1875Z" fill="#666666"/>
                                                <path d="M12.3708 11.6994L12.0674 12.0194C12.0674 12.0194 11.3454 12.7788 9.37529 10.7046C7.40518 8.63053 8.12722 7.87116 8.12722 7.87116L8.31857 7.66915C8.78926 7.17312 8.83393 6.37708 8.42257 5.79571L7.58253 4.60698C7.07316 3.88694 6.08978 3.79226 5.50641 4.4063L4.46035 5.50703C4.17167 5.81171 3.97833 6.20573 4.00166 6.64376C4.06166 7.76382 4.54036 10.1726 7.20984 12.9841C10.0413 15.9643 12.6981 16.0829 13.7842 15.9756C14.1282 15.9423 14.4269 15.7563 14.6676 15.5029L15.6143 14.5055C16.2543 13.8322 16.0743 12.6788 15.2556 12.2081L13.9822 11.4747C13.4449 11.166 12.7908 11.2567 12.3708 11.6987V11.6994Z" fill="#666666"/>
                                                </svg>
                                            </div>
                                            <span>Call</span>
                                        </div>
    
                                    </li>`
                    }
                    if (num.capabilities.SMS === true) {
                        card += `
                                    <li>
                                        <div class="icon mr-1">
                                            <div class="icon icon-sm">
                                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd" clip-rule="evenodd" d="M10.6522 15.6328L10.9774 15.0832C11.2294 14.6572 11.3554 14.4436 11.5582 14.326C11.761 14.2078 12.016 14.2036 12.526 14.1946C13.2796 14.182 13.7518 14.1358 14.1478 13.9714C14.5118 13.8206 14.8425 13.5997 15.1211 13.3211C15.3997 13.0425 15.6206 12.7118 15.7714 12.3478C16 11.797 16 11.098 16 9.7V9.1C16 7.1362 16 6.154 15.5578 5.4328C15.3106 5.02912 14.9713 4.68967 14.5678 4.4422C13.846 4 12.8638 4 10.9 4H9.1C7.1362 4 6.154 4 5.4328 4.4422C5.02912 4.68942 4.68967 5.02867 4.4422 5.4322C4 6.154 4 7.1368 4 9.1V9.7C4 11.098 4 11.797 4.228 12.3478C4.37883 12.7118 4.59991 13.0426 4.87859 13.3212C5.15727 13.5998 5.48811 13.8207 5.8522 13.9714C6.2482 14.1358 6.7204 14.1814 7.474 14.1946C7.984 14.2036 8.239 14.2078 8.4418 14.326C8.644 14.4436 8.7706 14.6566 9.0226 15.0832L9.3478 15.6328C9.6376 16.1224 10.3618 16.1224 10.6522 15.6328ZM12.4 10C12.5591 10 12.7117 9.93679 12.8243 9.82426C12.9368 9.71174 13 9.55913 13 9.4C13 9.24087 12.9368 9.08826 12.8243 8.97574C12.7117 8.86321 12.5591 8.8 12.4 8.8C12.2409 8.8 12.0883 8.86321 11.9757 8.97574C11.8632 9.08826 11.8 9.24087 11.8 9.4C11.8 9.55913 11.8632 9.71174 11.9757 9.82426C12.0883 9.93679 12.2409 10 12.4 10ZM10.6 9.4C10.6 9.55913 10.5368 9.71174 10.4243 9.82426C10.3117 9.93679 10.1591 10 10 10C9.84087 10 9.68826 9.93679 9.57574 9.82426C9.46321 9.71174 9.4 9.55913 9.4 9.4C9.4 9.24087 9.46321 9.08826 9.57574 8.97574C9.68826 8.86321 9.84087 8.8 10 8.8C10.1591 8.8 10.3117 8.86321 10.4243 8.97574C10.5368 9.08826 10.6 9.24087 10.6 9.4ZM7.6 10C7.75913 10 7.91174 9.93679 8.02426 9.82426C8.13679 9.71174 8.2 9.55913 8.2 9.4C8.2 9.24087 8.13679 9.08826 8.02426 8.97574C7.91174 8.86321 7.75913 8.8 7.6 8.8C7.44087 8.8 7.28826 8.86321 7.17574 8.97574C7.06321 9.08826 7 9.24087 7 9.4C7 9.55913 7.06321 9.71174 7.17574 9.82426C7.28826 9.93679 7.44087 10 7.6 10Z" fill="#666666"/>
                                                </svg>
                                            </div>
                                            <span>SMS</span>
                                        </div>
    
                                    </li>`
                    }
                    if (num.capabilities.MMS === true) {
                        card += `
                                    <li>
                                        <div class="icon mr-1">
                                            <div class="icon icon-sm">
                                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <g id="material-symbols:mms-rounded">
                                                <path id="Vector" d="M7.22474 11.7394H13.6742C13.8032 11.7394 13.9 11.6803 13.9645 11.562C14.0289 11.4438 14.0182 11.3309 13.9322 11.2234L12.1586 8.85324C12.0941 8.76724 12.0081 8.72425 11.9006 8.72425C11.7931 8.72425 11.7071 8.76724 11.6426 8.85324L9.96577 11.0944L8.77262 9.49819C8.70812 9.41219 8.62213 9.3692 8.51464 9.3692C8.40715 9.3692 8.32115 9.41219 8.25666 9.49819L6.96676 11.2234C6.88077 11.3309 6.87002 11.4438 6.93452 11.562C6.99901 11.6803 7.09575 11.7394 7.22474 11.7394ZM6.57979 14.3192L5.09641 15.8026C4.89218 16.0068 4.65828 16.0526 4.39471 15.9399C4.13114 15.8273 3.99957 15.6256 4 15.335V5.2899C4 4.93518 4.12641 4.63141 4.37923 4.37859C4.63205 4.12577 4.93561 3.99957 5.2899 4H15.6091C15.9638 4 16.2676 4.12641 16.5204 4.37923C16.7732 4.63205 16.8994 4.93561 16.899 5.2899V13.0293C16.899 13.384 16.7726 13.6878 16.5197 13.9406C16.2669 14.1934 15.9634 14.3196 15.6091 14.3192H6.57979Z" fill="#666666"/>
                                                </g>
                                                </svg>
                                            </div>
                                            <span>MMS</span>
                                        </div>
                                    </li>
                                `
                    }
                    card += `
                                </ul>
                                </div>
                                </div>
    
                        </div>
                    `
                    cardNum.innerHTML += card
                }
                else {
                    var card = `<div class="card card-sm card-bordered">
                <div class="i-block block-relative">
                    <div class="block-absolute block-absolute--right p-0 text-700 card-price">
                        <span class="text-12">$ ${num.price}</span>
                    </div>
                    <div class="block-absolute block-absolute--right p-0 text-warning">
                        <span class="text-small">+ Subscription fee</span>
                    </div>
                    <div class="i-block__img icon mr-2">
                        <div class="icon-bg icon-md">
                            <div class="${ele[0].className}"></div>
                        </div>
                    </div>
                    <div class="i-block__content">
                        <span class="d-block mb-1 card-num">${num.dialing_number}</span>
                        <ul class="d-flex pl-0 mb-0">
                        `
                    if (num.capabilities.voice === true) {
                        card += `
                                <li>
                                    <div class="i-block">
                                        <div class="i-block__img icon mr-1">
                                            <div class="icon icon-sm">
                                                <img src="/wp-content/themes/mitech/src/assets/images/svg/icons/icon-call.svg" alt="Call">
                                            </div>
                                        </div>
                                    </div>
                                </li>`
                    }
                    if (num.capabilities.SMS === true) {
                        card += `
                                <li>
                                    <div class="i-block">
                                        <div class="i-block__img icon mr-1">
                                            <div class="icon icon-sm">
                                                <img src="/wp-content/themes/mitech/src/assets/images/svg/icons/icon-msg.svg" alt="SMS">
                                            </div>
                                        </div>
                                    </div>
                                </li>`
                    }
                    if (num.capabilities.MMS === true) {
                        card += `
                                <li>
                                    <div class="i-block">
                                        <div class="i-block__img icon mr-1">
                                            <div class="icon icon-sm">
                                                <img src="/wp-content/themes/mitech/src/assets/images/svg/icons/icon-photo.svg" alt="MMS">
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            `
                    }
                    card += `
                            </ul>
                            </div>
                            </div>
    
                    </div>
                `
                    cardNum.innerHTML += card
                }
            }



            //render country list
            function renderList() {
                // let response = await fetch('https://staging.krispcall.com/wp-content/themes/mitech/src/assets/data/country.json'),
                let wrapper = document.getElementById('cc-list');
                wrapper.innerHTML = '';
                cnWithNum = ['brazil', 'new-zealand', 'iceland'];
                iti.countries.forEach(item => {
                    var countryNameRaw = $.trim(item.name.split("(")[0]),
                        replaceItem = 'and',
                        regex = new RegExp("\\b" + replaceItem + "\\b", "g");
                    getUrl = countryNameRaw.toLowerCase().split(' ').join('-'),
                        getUrl = (getUrl == 'united-states') ? 'usa' : getUrl,
                        countryName = countryNameRaw.replace(regex, '&'),
                        countryName = (countryName == 'United Kingdom') ? 'UK' : countryName;
                    countryName = (countryName == 'United States') ? 'US' : countryName;
                    if (cnWithNum.includes(getUrl)) {
                        getUrl = getUrl + '-number'

                    }
                    // var list = `<li><a href="${item.name}"><img src="https://staging.krispcall.com/wp-content/themes/mitech/src/assets/images/country-flags/flag-${item.image}.svg" alt ="${item.name}" width="16" height="16">${item.name} Phone Number</li></a>`;
                    list = `<li><a href="/virtual-phone-number/${getUrl}/"><span class="iti__flag  iti__${item.iso2} d-inline-block"></span>${countryName} Phone Number</li></a>`;
                    wrapper.innerHTML += list;
                });
            }

            setTimeout(function () {
                renderList();
            }, 100);

            //Send partnerStack ID to krispCall App while register from website
            var setPartnerStackParams = window.location.search;
            getStartedBtns = document.querySelectorAll('.appRegister');
            // const userArray = ["mode",currentLoc];
            if (setPartnerStackParams)
                localStorage.setItem("storeParams", setPartnerStackParams);

            Array.from(getStartedBtns).forEach(item => {
                var storeParams = localStorage.getItem("storeParams");
                appRegisterUrl = `https://app.krispcall.com/register/${storeParams}`;
                if (!storeParams) {
                    return;
                }
                else {
                    item.addEventListener('click', function (e) {
                        e.target.href = appRegisterUrl;
                    })
                }
            })


        </script>
    </footer>
</body>

</html>